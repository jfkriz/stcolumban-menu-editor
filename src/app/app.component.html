<div class='container-fluid' *ngIf="isReady">
  <div class="panel panel-default">
    <tabset>
      <tab heading="Entrees">
        <table class="table table-striped">
            <thead>
              <tr>
                <th>Name</th>
                <th>Description</th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of menuData.entrees">
                <td *ngIf="!item.editing">{{item.id}}</td>
                <td *ngIf="!item.editing">{{item.description}}</td>
                <td *ngIf="item.editing"><input type="text" class="form-control" [(ngModel)]="item.id" /></td>
                <td *ngIf="item.editing"><input type="text" class="form-control" [(ngModel)]="item.description" /></td>
                <td *ngIf="!item.editing">
                  <i class="fa fa-pencil" aria-hidden="true" (click)="editItem(item)"></i>
                  <i class="fa fa-trash" aria-hidden="true" (click)="deleteItem(menuData.entrees, item)"></i>
                </td>
                <td *ngIf="item.editing">
                  <i class="fa fa-check" aria-hidden="true" (click)="confirmEditItem(menuData.entrees, item)"></i>
                  <i class="fa fa-ban" aria-hidden="true" (click)="cancelEditItem(item)"></i>
                </td>
              </tr>
            </tbody>
          </table>
          <button type="button" class="btn" (click)="addNewEntree()">Add Item</button>
        </tab>
      <tab heading="Veggies">
        <table class="table table-striped">
            <thead>
              <tr>
                <th>Name</th>
                <th>Description</th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of menuData.veggies">
                <td *ngIf="!item.editing">{{item.id}}</td>
                <td *ngIf="!item.editing">{{item.description}}</td>
                <td *ngIf="item.editing"><input type="text" class="form-control" [(ngModel)]="item.id" /></td>
                <td *ngIf="item.editing"><input type="text" class="form-control" [(ngModel)]="item.description" /></td>
                <td *ngIf="!item.editing">
                  <i class="fa fa-pencil" aria-hidden="true" (click)="editItem(item)"></i>
                  <i class="fa fa-trash" aria-hidden="true" (click)="deleteItem(menuData.veggies, item)"></i>
                </td>
                <td *ngIf="item.editing">
                  <i class="fa fa-check" aria-hidden="true" (click)="confirmEditItem(menuData.veggies, item)"></i>
                  <i class="fa fa-ban" aria-hidden="true" (click)="cancelEditItem(item)"></i>
                </td>
              </tr>
            </tbody>
          </table>
          <button type="button" class="btn" (click)="addNewVeggie()">Add Item</button>
        </tab>
      <tab heading="Treats">
        <table class="table table-striped">
          <thead>
            <tr>
              <th>Name</th>
              <th>Description</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of menuData.treats">
              <td *ngIf="!item.editing">{{item.id}}</td>
              <td *ngIf="!item.editing">{{item.description}}</td>
              <td *ngIf="item.editing"><input type="text" class="form-control" [(ngModel)]="item.id" /></td>
              <td *ngIf="item.editing"><input type="text" class="form-control" [(ngModel)]="item.description" /></td>
              <td *ngIf="!item.editing">
                <i class="fa fa-pencil" aria-hidden="true" (click)="editItem(item)"></i>
                <i class="fa fa-trash" aria-hidden="true" (click)="deleteItem(menuData.treats, item)"></i>
              </td>
              <td *ngIf="item.editing">
                <i class="fa fa-check" aria-hidden="true" (click)="confirmEditItem(menuData.treats, item)"></i>
                <i class="fa fa-ban" aria-hidden="true" (click)="cancelEditItem(item)"></i>
              </td>
            </tr>
          </tbody>
        </table>
        <button type="button" class="btn" (click)="addNewTreat()">Add Item</button>
      </tab>
    </tabset>
  </div>
  <div class='row'>
    <div class="col-md-12">
      <div class="panel panel-default" data-role="panel">
        <div class="panel-heading" (click)="isDaysCollapsed = !isDaysCollapsed">Menu Days</div>
        <form>
          <div class="panel-body" [collapse]="isDaysCollapsed">
            <table class="table table-striped">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Entree</th>
                  <th>Veggie</th>
                  <th>Treat</th>
                  <th></th>
                </tr>
              </thead>
                <tbody>
                  <tr *ngFor="let date of menuData.dates | objectValues">
                    <td>
                      <span *ngIf="!date.val.editing || !date.val.allowEditDate">{{date.key}}</span>
                      <span *ngIf="date.val.editing && date.val.allowEditDate">Edit: {{date.key}}</span>
                    </td>
                    <td>
                      <span *ngIf="!date.val.editing">{{date.val.entree | menuItem:menuData.entrees}}</span>
                      <span *ngIf="date.val.editing">Edit: {{date.val.entree | menuItem:menuData.entrees}}</span>
                      <ng-select *ngIf="date.val.editing"
                        [multiple]="true"
                        [items]="menuData.entrees"
                        (data)="updateMenuDate($event, date.val.entreesObj)"
                        [active]="date.val.entrees ? date.val.entreesObj : undefined">
                      </ng-select>
                    </td>
                    <td>
                      <span *ngIf="!date.val.editing">{{date.val.veggie | menuItem:menuData.veggies}}</span>
                      <ng-select *ngIf="date.val.editing"
                        [multiple]="false"
                        [items]="menuData.veggies"
                        (data)="updateMenuDate($event, date.val.veggieObj)"
                        [active]="date.val.veggie ? [ date.val.veggieObj ] : undefined">
                      </ng-select>
                    </td>
                    <td>
                      <span *ngIf="!date.val.editing">{{date.val.treat | menuItem:menuData.treats}}</span>
                      <ng-select *ngIf="date.val.editing"
                        [multiple]="false"
                        [items]="menuData.treats"
                        (data)="updateMenuDate($event, date.val.treatObj)"
                        [active]="date.val.treat ? [ date.val.treatObj ] : undefined">
                      </ng-select>
                    </td>
                    <td *ngIf="!date.val.editing">
                      <i class="fa fa-pencil" aria-hidden="true" (click)="editDate(date.val)"></i>
                      <i class="fa fa-trash" aria-hidden="true" (click)="deleteDate(date.key)"></i>
                    </td>
                    <td *ngIf="date.val.editing">
                      <i class="fa fa-check" aria-hidden="true" (click)="confirmEditDate(date.val)"></i>
                      <i class="fa fa-ban" aria-hidden="true" (click)="cancelEditDate(date.val)"></i>
                    </td>
                  </tr>
              </tbody>
            </table>
            <button type="button" class="btn" (click)="addNewMenuDate()">Add Date</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  <div class='row'>
    <div class="col-md-12">
      <div class="panel panel-default" data-role="panel">
        <div class="panel-heading" (click)="isJsonCollapsed = !isJsonCollapsed">JSON Menu</div>
        <div class="panel-body" [collapse]="isJsonCollapsed">
          <div class="form-group">
            <label class="control-label-left" for="json">JSON</label>
            <textarea id="json" type="textarea" rows="50" class="form-control">{{getJsonMenu()}}</textarea>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
